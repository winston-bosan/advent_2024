{-# LANGUAGE ScopedTypeVariables #-}

module Main where

import Data.Foldable (Foldable (fold))
import Data.List (sort)
import Text.ParserCombinators.ReadP (count)

removeNonUppercase :: String -> String
removeNonUppercase st = [c | c <- st, c `elem` ['A' .. 'Z']]

zippedItemDif :: [(Int, Int)] -> [Int]
zippedItemDif [] = []
zippedItemDif ((l, r) : rest) = [abs (l - r)] ++ zippedItemDif rest

integerListToStr :: [Int] -> [Char]
integerListToStr [] = ""
integerListToStr l = show l

unique :: [Int] -> [Int]
unique [] = []
unique (x : rest) = x : unique (filter (/= x) rest)

-- Unique set first
countUnique :: [Int] -> [Int] -> [(Int, Int)]
countUnique [] _ = []
countUnique _ [] = []
countUnique (x : rest) li = (x, length (filter (== x) li)) : countUnique rest li

isMatchingIndex :: Int -> (Int, Int) -> Bool
isMatchingIndex x (a, _b) = x == a

searchForCount :: Int -> [(Int, Int)] -> Int
searchForCount x index =
  if any (isMatchingIndex x) index
    then snd (head (filter (isMatchingIndex x) index))
    else 0

left :: [Int]
left :: [Int] = [57643, 19062, 11105, 72032, 16289, 42361, 45873, 16167, 57216, 15920, 22534, 38721, 27502, 17094, 84849, 20884, 21987, 39419, 10839, 77870, 94474, 29876, 72281, 52066, 11847, 83711, 47340, 54869, 63495, 87421, 12673, 21401, 13800, 35534, 51304, 51515, 25160, 39133, 68329, 56917, 68841, 27693, 82953, 47353, 70002, 74154, 86034, 95639, 45722, 69049, 51692, 39166, 30495, 81255, 60454, 26224, 74983, 55752, 22465, 57854, 94700, 83099, 26617, 23277, 34125, 61685, 49752, 82839, 28748, 19753, 76703, 41076, 94607, 88668, 56446, 93070, 25427, 51967, 23531, 44724, 32642, 54203, 62977, 31242, 94016, 55953, 35527, 54207, 44027, 82186, 72150, 68617, 57085, 18164, 28818, 94464, 73344, 76429, 25559, 24143, 12888, 33654, 13309, 90824, 42199, 99525, 60919, 14832, 83140, 68116, 35265, 30971, 84947, 35362, 98472, 32851, 47123, 37165, 64938, 39094, 32542, 70739, 59747, 51960, 75826, 96621, 80372, 15595, 17009, 87108, 70344, 12951, 25963, 60994, 26308, 58823, 18153, 20975, 42013, 53539, 40729, 10964, 76208, 55734, 29742, 40999, 61760, 57734, 32323, 53967, 41453, 53895, 99823, 12983, 71421, 76964, 82841, 55517, 75661, 22232, 36803, 83930, 54392, 67783, 78834, 46044, 97734, 16374, 23972, 80360, 48876, 11260, 53596, 60950, 37956, 87063, 66760, 24341, 13907, 39084, 30798, 30370, 57538, 41199, 79187, 43099, 13070, 39307, 89252, 94161, 91119, 97429, 64997, 32145, 13342, 82088, 61898, 72616, 17954, 58825, 44525, 28074, 17636, 94958, 48971, 85361, 82391, 69603, 64066, 65092, 49086, 42231, 56734, 76829, 99378, 59516, 18672, 68792, 46265, 28964, 14875, 95708, 38828, 56799, 40443, 64615, 27557, 89585, 67867, 28621, 88258, 73478, 98662, 38098, 76219, 23664, 70807, 64392, 39683, 47297, 25007, 90841, 82423, 56193, 83332, 17826, 95927, 62664, 33750, 51457, 47908, 67000, 66855, 20055, 60010, 30431, 12321, 53585, 55043, 20000, 28871, 82812, 13060, 70027, 80606, 55151, 63800, 35192, 78917, 92483, 10457, 70963, 67927, 36688, 93141, 93362, 81614, 81186, 56418, 64292, 43290, 10656, 38812, 33000, 18100, 37989, 14064, 14399, 22066, 49658, 29682, 59980, 91466, 70211, 35905, 67755, 75456, 54074, 23976, 22224, 78250, 53819, 99580, 49653, 13703, 39210, 13265, 70869, 42643, 97800, 33668, 62475, 64693, 31715, 83449, 33033, 39765, 93890, 23400, 92189, 63780, 73093, 13323, 69167, 48878, 13718, 27903, 69456, 46468, 52145, 20909, 22536, 80514, 98390, 78956, 23497, 15348, 61890, 89951, 20728, 49303, 30422, 73676, 49698, 76046, 45242, 25389, 32448, 59354, 70423, 89306, 59766, 37037, 65021, 54230, 43969, 50630, 54139, 85677, 47692, 21467, 83644, 21789, 13648, 28017, 74883, 16109, 46184, 36000, 33728, 44888, 11222, 36641, 42426, 93707, 82249, 86185, 63476, 52464, 33497, 51699, 67877, 16955, 49928, 16708, 91134, 24080, 16031, 49022, 88710, 22505, 22483, 10981, 74260, 53783, 67774, 56303, 87017, 25003, 54386, 55011, 35564, 43205, 90317, 65967, 27412, 26888, 50833, 90825, 68203, 51609, 69744, 56356, 89107, 88509, 92237, 44066, 80980, 98957, 22264, 60969, 17620, 90800, 62862, 27780, 66419, 70524, 26486, 72422, 90508, 28259, 14239, 21310, 35507, 77638, 10307, 71173, 39165, 92119, 52470, 18950, 55271, 25924, 55619, 48809, 32300, 60316, 44763, 25666, 81291, 60771, 81653, 67405, 79747, 47382, 29989, 50331, 17848, 89637, 98116, 80694, 95798, 78442, 45090, 23385, 86919, 71255, 82002, 89066, 98896, 27000, 99089, 13394, 20748, 88835, 87101, 61684, 87896, 97799, 63040, 85411, 34131, 65406, 91155, 65832, 81208, 85395, 16926, 35793, 12707, 67126, 92795, 91840, 54768, 52180, 53100, 73239, 49380, 80253, 53209, 11121, 44463, 53271, 69448, 36173, 60547, 54971, 44418, 66775, 71561, 32773, 76204, 98547, 24876, 33855, 28306, 30050, 21242, 19505, 54591, 72512, 10186, 98061, 83084, 38957, 56756, 36706, 82325, 24632, 55788, 21147, 97814, 76627, 83496, 35495, 57929, 44008, 68284, 58203, 33603, 91850, 55632, 48086, 96381, 77170, 39336, 74736, 92977, 74412, 99801, 51368, 68476, 21734, 85160, 67622, 33195, 99282, 40016, 70136, 60848, 79546, 71409, 48029, 75919, 26206, 26139, 98726, 75480, 60703, 56290, 20547, 85264, 72745, 11648, 89927, 41626, 40096, 11676, 38937, 95166, 45499, 44553, 58227, 78021, 31576, 25095, 62956, 87587, 37318, 31960, 44972, 47152, 48034, 99245, 51671, 31412, 19038, 30040, 81022, 28727, 63343, 44062, 52098, 32337, 10627, 86438, 11359, 79827, 50991, 41506, 64427, 30314, 55147, 24076, 55139, 84755, 77418, 65841, 89026, 43842, 69091, 45281, 76721, 85918, 75795, 25664, 97570, 52566, 56772, 66023, 70877, 58489, 97243, 90065, 15509, 16396, 52851, 27226, 90734, 69265, 52153, 62294, 60456, 22359, 72820, 16060, 48347, 93708, 40506, 34923, 82726, 75211, 42580, 55998, 36766, 49855, 95715, 88333, 43573, 58068, 65789, 26337, 41559, 94353, 60210, 31864, 43486, 89008, 40463, 69990, 43940, 77221, 75112, 10957, 74710, 59368, 32133, 75434, 14918, 78742, 47615, 92968, 34542, 38734, 10118, 43713, 82778, 90759, 65951, 60584, 74575, 79698, 25005, 87205, 61821, 91262, 59774, 25663, 59643, 91239, 67918, 90338, 46014, 83831, 61964, 93797, 31368, 25677, 98724, 45567, 58366, 97070, 42402, 30156, 21792, 88704, 86958, 87735, 46436, 67398, 25402, 75281, 10908, 13665, 14289, 78567, 58378, 70508, 27417, 39259, 75173, 67055, 94446, 13538, 47472, 73403, 80112, 53479, 68774, 15947, 98908, 34832, 49962, 37504, 75818, 61492, 46636, 60015, 91286, 37897, 92495, 86458, 39276, 22884, 71464, 32095, 54595, 24423, 22187, 82210, 19488, 65566, 77921, 17295, 91582, 24317, 68159, 81663, 78357, 36492, 53202, 64614, 13683, 46365, 61031, 52374, 24823, 90438, 14871, 65089, 37779, 39308, 32476, 61005, 22943, 87147, 25126, 16978, 60815, 84082, 73857, 18643, 90549, 30337, 62788, 36450, 18667, 31868, 34793, 87706, 24983, 49759, 88262, 75939, 19997, 62343, 45616, 45860, 68344, 55812, 58211, 57040, 60518, 71099, 24428, 54582, 55276, 58848, 75393, 11569, 88739, 92898, 91074, 68506, 28953, 40480, 78476, 52052, 38383, 94501, 11804, 88802, 14159, 31951, 71802, 51736, 40245, 76174, 65410, 77053, 47630, 22202, 67248, 18768, 75554, 91793, 15692, 78398, 64570, 85672, 32952, 72503, 62594, 14375, 98715, 68922, 14526, 47522, 58875, 90570, 36853, 72716, 64202, 18894, 16184, 18595, 68531, 29435, 48615, 90773, 65539, 37091, 85835, 93470, 71460, 67920, 71775, 31403, 68444, 57842, 12734, 14195, 63687, 19494, 28761, 64063, 90511, 47699, 99339, 64610, 30124, 44098, 92946, 63078, 69198, 81067, 27276, 60707, 92750, 15611, 80632, 81434, 31643, 12277, 94027, 65878, 88364, 66635, 70736, 94291, 96756, 74141, 99623, 47960, 67373, 44303, 24370, 41710, 27632, 14584, 12530, 99369, 47344, 69327, 51570, 29199, 16964, 95237, 22379, 85798, 25053, 61660, 41800, 16124, 63219, 81668, 75520, 99726, 38012, 38268, 92610, 27885, 21596, 67364, 75268, 91852, 62389, 10196, 92074, 29408, 21662, 13219, 13114, 48531, 71249, 67554, 86260, 87497, 16230, 38758, 84298, 84242, 95389, 77666, 79652, 83324, 53778, 43407, 99150, 16081, 73980, 63828, 47913, 67136, 97672, 98377, 36910, 61140, 69501, 91030, 37044, 71591, 87886, 51030, 12076, 82030, 28642, 45176, 44774, 35230, 85460, 95631, 77427, 26839, 98740, 55636, 14543, 71485, 78254, 28704]
right :: [Int]
right :: [Int] = [17620, 47340, 16109, 30050, 65967, 35795, 16124, 65832, 47340, 71163, 30837, 64603, 32313, 50986, 67526, 64392, 59516, 98547, 29910, 15917, 57604, 18768, 16109, 21561, 24044, 11404, 29941, 62664, 62664, 46184, 51492, 77546, 70131, 46986, 41199, 39683, 55295, 88509, 62664, 84849, 33033, 78397, 22601, 27226, 59980, 16109, 84849, 62349, 59516, 22317, 17620, 65967, 55388, 17869, 41199, 81511, 16124, 90759, 24501, 22943, 59516, 31049, 32773, 52176, 18754, 11874, 44170, 26115, 62664, 73220, 16124, 60454, 98100, 47340, 90759, 65832, 65524, 16964, 92947, 76864, 60237, 22536, 69799, 64392, 75284, 84849, 83890, 16964, 46184, 60112, 28927, 89252, 65832, 39683, 61894, 96385, 17681, 27054, 84215, 65907, 93195, 52859, 67042, 55187, 61494, 33401, 59516, 74668, 90759, 75402, 16124, 57216, 98547, 15902, 65832, 30050, 23601, 73599, 97672, 16964, 84849, 89107, 65832, 87068, 16109, 92566, 60656, 92864, 59796, 16124, 85636, 89107, 41199, 12246, 96930, 37556, 72254, 11570, 30141, 39683, 63401, 17620, 18768, 12636, 14160, 33033, 47123, 85993, 17620, 71169, 60454, 39683, 30156, 20098, 47829, 33049, 87433, 47340, 17620, 16081, 33033, 32773, 29132, 27226, 34040, 60454, 41199, 82621, 39787, 33654, 34378, 16124, 71313, 65832, 90734, 64392, 90734, 90734, 56662, 64270, 22591, 22943, 93797, 60454, 25199, 18768, 20881, 45484, 40350, 81798, 39683, 39599, 20578, 98547, 90759, 58672, 62664, 78897, 71652, 68383, 30658, 33033, 16124, 61724, 47340, 48120, 68794, 23741, 13582, 45163, 32773, 98547, 81797, 30156, 42745, 22285, 47123, 97672, 17620, 77566, 61068, 23528, 65832, 51315, 92737, 32773, 27226, 76621, 61305, 65979, 32773, 16124, 32773, 90759, 18768, 32773, 82839, 16109, 87325, 91952, 37572, 32773, 60454, 59516, 82839, 59516, 82839, 88503, 27771, 90759, 27341, 30050, 14734, 52372, 16109, 95964, 30156, 88159, 18768, 73383, 41199, 89107, 71616, 36310, 30050, 27226, 64392, 66432, 29589, 32773, 20728, 57216, 91119, 67070, 64392, 16124, 94940, 66565, 60166, 70331, 65832, 27226, 40982, 16124, 17109, 85483, 82711, 16964, 72604, 47123, 59516, 19363, 89107, 30342, 27226, 17620, 10664, 65832, 91119, 80267, 16081, 26866, 53011, 89107, 18768, 33033, 19583, 74044, 64392, 80872, 90759, 21888, 83264, 99185, 13990, 91104, 60517, 60670, 17620, 93768, 16109, 50153, 89107, 61436, 55630, 57216, 94896, 16109, 60454, 30596, 89107, 67083, 43159, 36556, 60454, 55983, 47123, 90734, 31879, 79394, 30713, 57216, 33033, 81919, 17620, 84849, 40202, 47299, 82839, 89252, 65967, 27268, 98547, 18895, 18768, 63446, 65832, 88509, 88746, 37399, 22536, 67594, 97672, 90759, 57216, 49798, 72646, 30050, 44597, 22536, 59516, 30050, 78012, 18768, 90734, 39683, 79158, 45090, 24645, 47340, 31223, 36634, 69854, 61017, 62664, 29644, 98547, 91119, 74628, 44253, 27651, 33033, 76873, 90620, 62664, 16124, 66706, 74124, 57216, 20728, 32773, 45090, 90759, 96125, 57216, 88804, 67612, 83419, 16964, 18108, 69179, 65832, 89107, 54941, 65832, 90734, 36406, 58864, 60659, 41199, 33654, 40115, 93572, 64392, 18768, 60454, 86222, 27226, 98298, 30050, 41199, 39683, 86711, 62664, 83310, 33033, 98232, 57216, 86108, 17765, 42325, 29040, 56949, 20728, 18768, 53100, 16153, 74270, 16964, 67521, 93797, 16964, 89107, 52151, 33033, 34981, 44690, 60454, 18768, 64392, 45090, 10999, 99645, 94611, 62664, 59516, 33033, 97672, 16109, 86008, 64545, 90734, 18768, 89107, 47340, 16109, 82505, 16081, 20728, 62664, 89107, 74658, 83937, 99556, 33674, 55861, 46184, 99827, 30050, 57216, 52814, 88509, 84607, 65833, 17819, 30156, 69810, 49485, 76262, 49131, 33033, 39683, 84849, 76937, 63218, 75774, 27226, 65832, 19905, 21069, 91318, 81715, 16081, 22287, 90759, 16554, 12914, 90734, 14213, 48135, 73973, 72386, 42401, 32773, 53473, 98547, 32773, 47179, 90734, 34600, 25888, 89467, 57216, 45700, 16109, 30156, 37332, 20370, 59516, 91682, 39247, 16124, 33894, 10569, 84849, 85833, 15527, 93797, 47340, 58501, 17620, 27226, 45090, 91119, 80512, 32773, 17620, 59575, 10061, 67727, 47112, 16964, 34780, 45090, 47123, 17620, 47340, 16333, 16081, 16109, 97672, 17620, 41885, 15733, 64392, 22536, 98547, 97594, 27226, 92683, 90759, 19438, 32773, 33033, 78113, 59274, 43830, 48890, 26768, 84849, 30050, 55462, 69405, 57216, 20728, 92094, 53100, 16109, 24270, 89381, 62053, 90734, 20786, 69696, 47340, 91119, 97672, 78893, 73474, 64392, 58282, 38013, 51690, 97672, 30156, 65832, 39683, 83092, 17102, 17620, 92274, 97447, 57216, 30383, 30156, 55704, 15961, 56257, 46184, 70725, 60352, 17620, 16081, 96590, 87622, 64392, 96477, 46960, 16124, 45713, 56385, 56305, 47123, 59516, 22831, 88509, 11949, 16109, 97672, 16152, 16124, 45090, 26606, 60454, 57216, 37173, 64233, 46280, 94103, 43319, 67256, 16081, 39630, 22943, 48776, 81825, 89107, 29137, 22547, 30050, 56443, 18768, 98547, 78948, 12120, 89107, 33654, 72998, 89107, 51635, 59414, 71551, 22943, 20291, 56801, 55518, 90734, 30050, 35684, 97672, 65365, 39683, 97672, 41199, 69895, 36850, 16124, 56501, 18768, 18768, 27226, 27226, 25578, 87690, 47340, 89252, 90759, 59638, 62664, 23553, 44041, 22943, 45061, 39747, 97672, 43711, 65967, 69189, 97038, 89243, 95547, 39683, 56544, 32898, 22943, 19318, 27226, 16670, 79914, 31265, 18768, 58536, 58240, 93924, 98146, 95703, 90734, 39683, 79739, 88002, 95443, 33654, 97672, 59516, 52244, 45090, 36056, 16109, 46184, 91119, 32773, 93797, 61612, 56365, 45090, 87760, 27226, 94229, 91119, 48731, 88509, 68008, 62589, 92247, 45090, 89107, 94508, 79967, 23724, 65832, 85336, 36692, 30156, 82672, 18768, 45090, 97672, 32489, 87616, 20993, 16124, 12698, 80660, 17620, 46184, 89107, 13389, 93342, 72087, 93797, 67867, 64984, 61047, 32773, 84849, 91530, 27226, 17135, 50284, 89107, 76729, 58359, 76480, 64392, 88556, 56462, 97672, 93888, 11535, 68813, 30050, 57926, 32773, 57155, 57216, 90308, 55066, 20728, 97672, 68342, 60454, 83347, 19081, 78420, 64392, 68489, 33654, 90759, 69088, 58424, 92541, 72137, 20700, 25669, 90759, 93797, 33196, 79841, 39683, 79537, 62664, 73334, 27226, 84849, 41199, 16109, 97672, 96505, 60454, 37902, 93797, 46027, 47340, 98105, 68010, 64392, 19785, 65951, 93129, 60939, 47817, 53863, 27240, 93797, 62664, 45090, 45090, 94452, 33033, 97672, 16964, 16124, 90759, 32585, 16320, 93186, 80052, 74944, 89107, 65832, 35998, 41229, 73891, 65967, 70887, 50742, 17620, 90759, 74495, 87080, 39683, 39683, 60454, 71049, 19253, 66283, 62664, 16124, 10833, 93797, 22536, 30050, 89107, 46282, 98547, 46619, 49881, 33033, 46184, 73977, 21223, 98354, 64392, 28999, 91119, 97672, 41607, 47340, 22536, 38508, 20728, 33033, 18768, 16541, 11107, 46184, 61946, 29761, 90759, 41199, 27180, 62664, 95048, 35616, 28270, 39683, 79737, 16081, 93797, 13109, 26416, 91119, 24011, 97672, 98704, 21659, 84076, 53612, 47123, 31697, 32940, 89107, 21512, 31805, 20665, 79621, 59516, 70849, 46623, 90759, 30050, 16124, 86465, 73820, 44579, 62664, 57216, 83484, 59782, 29507, 17620, 58641, 59516, 97390, 90734, 75087, 16109, 93797, 96356, 45251, 16124, 39683, 64392, 65967, 32551, 60454, 95851, 73711, 92783, 73053, 78500, 66420, 84991, 90759, 64392, 51814, 16109, 61007, 68306, 60454]

rightIndex :: [(Int, Int)]
rightIndex = countUnique (unique right) right

-- find unique elements in right sid, make it into a hashInteger

main :: IO ()
main = print (sum (map (\x -> searchForCount x rightIndex * x) left))

-- main = print rightIndex
